{"version":3,"sources":["tm_progress_timer.js"],"names":["cc","Class","extends","Component","properties","_curProgress","_oTime","_from","_to","_cb","_scoper","_showL","_type","progressBar","ProgressBar","timeLabel","Label","_isPause","start","run","from","to","cb","showL","scoper","unschedule","stepUpdate","_showTimeLabel","schedule","macro","REPEAT_FOREVER","stop","node","active","pause","resume","dt","call","str","string","Math","ceil"],"mappings":";;;;;;AAAA;;;AAGAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;;AAERC,sBAAa,CAFL;AAGRC,gBAAO,CAHC,EAGE;AACVC,eAAO,CAJC;AAKRC,aAAK,CALG;AAMRC,aAAK,IANG;AAORC,iBAAS,IAPD;AAQRC,gBAAQ,KARA,EAQO;AACfC,eAAO,CATC,EASE;;AAEVC,qBAAab,GAAGc,WAXR;AAYRC,mBAAWf,GAAGgB,KAZN;;AAcRC,kBAAU,KAdF,CAcS;AAdT,KAHP;;AAoBL;;AAEA;;AAEAC,SAxBK,mBAwBI,CAER,CA1BI;;;AA4BL;;;;;;;;AAQAC,OApCK,eAoCAC,IApCA,EAoCMC,EApCN,EAoCUC,EApCV,EAoCcC,KApCd,EAoCqBC,MApCrB,EAoC6B;AAC9B,aAAKP,QAAL,GAAgB,KAAhB;AACA,aAAKQ,UAAL,CAAgB,KAAKC,UAArB;;AAEA,aAAKnB,KAAL,GAAaa,IAAb;AACA,aAAKZ,GAAL,GAAWa,EAAX;AACA,aAAKZ,GAAL,GAAWa,EAAX;AACA,aAAKX,MAAL,GAAcY,KAAd;AACA,aAAKjB,MAAL,GAAc,KAAKC,KAAnB;AACA,aAAKG,OAAL,GAAec,MAAf;;AAEA,aAAKG,cAAL,CAAoB,KAAKpB,KAAzB;;AAEA,aAAKK,KAAL,GAAa,KAAKL,KAAL,GAAa,KAAKC,GAAlB,GAAwB,CAAxB,GAA4B,CAAzC;AACA,aAAKoB,QAAL,CAAc,KAAKF,UAAnB,EAA+B,CAA/B,EAAkC1B,GAAG6B,KAAH,CAASC,cAA3C,EAA2D,CAA3D,EAA8D,KAA9D;AACH,KAnDI;;;AAqDL;AACAC,QAtDK,kBAsDG;AACJ,aAAKJ,cAAL,CAAoB,CAApB;AACA,aAAKF,UAAL,CAAgB,KAAKC,UAArB;AACA,aAAKjB,GAAL,GAAW,IAAX;AACA,aAAKH,MAAL,GAAc,CAAd;AACA,aAAKC,KAAL,GAAa,CAAb;AACA,aAAKC,GAAL,GAAW,CAAX;AACA,aAAKG,MAAL,GAAc,KAAd;AACA,aAAKI,SAAL,CAAeiB,IAAf,CAAoBC,MAApB,GAA6B,KAA7B;AACH,KA/DI;;AAgEL;;AAEA;AACAC,SAnEK,mBAmEI;AACL,aAAKjB,QAAL,GAAgB,IAAhB;AACH,KArEI;;;AAuEL;AACAkB,UAxEK,oBAwEK;AACN,aAAKlB,QAAL,GAAgB,KAAhB;AACH,KA1EI;AA4ELS,cA5EK,sBA4EOU,EA5EP,EA4EW;AACZ,YAAG,KAAKnB,QAAR,EAAkB;AACd;AACH;;AAED,YAAG,KAAKL,KAAL,IAAc,CAAjB,EAAoB;AAChB,gBAAG,KAAKL,KAAL,MAAgB,KAAKC,GAAxB,EAA6B;AACzB,qBAAKC,GAAL,IAAY,KAAKA,GAAL,CAAS4B,IAAT,CAAc,KAAK3B,OAAnB,CAAZ;AACA,qBAAKqB,IAAL;AACH;AACJ,SALD,MAKO,IAAI,KAAKnB,KAAT,EAAgB;AACnB,gBAAG,KAAKL,KAAL,MAAgB,KAAKC,GAAxB,EAA6B;AACzB,qBAAKC,GAAL,IAAY,KAAKA,GAAL,CAAS4B,IAAT,CAAc,KAAK3B,OAAnB,CAAZ;AACA,qBAAKqB,IAAL;AACH;AACJ;;AAED,aAAKJ,cAAL,CAAoB,KAAKpB,KAAzB;AACH,KA9FI;;;AAgGL;AACAoB,oBAAgB,wBAAUW,GAAV,EAAe;AAC3B,YAAG,KAAK3B,MAAL,IAAe,KAAKI,SAAvB,EAAkC;AAC9B,iBAAKA,SAAL,CAAeiB,IAAf,CAAoBC,MAApB,GAA6B,IAA7B;AACA,iBAAKlB,SAAL,CAAewB,MAAf,GAAwBC,KAAKC,IAAL,CAAUH,GAAV,CAAxB;AACH;AACJ;;AAtGI,CAAT","file":"tm_progress_timer.js","sourceRoot":"../../../../../assets/commonScript/component","sourcesContent":["/**\n * 倒计时方法\n */\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        _curProgress:1,\n        _oTime:0, // 结束时间\n        _from: 0,\n        _to: 0,\n        _cb: null,\n        _scoper: null,\n        _showL: false, // 是否显示倒计时字符串\n        _type: 0, // 0 倒计时，1 增量\n\n        progressBar: cc.ProgressBar,\n        timeLabel: cc.Label,\n\n        _isPause: false, // 是否暂停\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n\n    },\n\n    /**\n     * TODO:\n     * @param dt\n     * @param from\n     * @param to\n     * @param cb\n     * @param stepCb -- 每一秒回调\n     */\n    run (from, to, cb, showL, scoper) {\n        this._isPause = false;\n        this.unschedule(this.stepUpdate);\n\n        this._from = from;\n        this._to = to;\n        this._cb = cb;\n        this._showL = showL;\n        this._oTime = this._from;\n        this._scoper = scoper;\n\n        this._showTimeLabel(this._from);\n\n        this._type = this._from > this._to ? 0 : 1;\n        this.schedule(this.stepUpdate, 1, cc.macro.REPEAT_FOREVER, 0, false);\n    },\n\n    // added by bruke\n    stop () {\n        this._showTimeLabel(0);\n        this.unschedule(this.stepUpdate);\n        this._cb = null;\n        this._oTime = 0;\n        this._from = 0;\n        this._to = 0;\n        this._showL = false;\n        this.timeLabel.node.active = false;\n    },\n    // end\n\n    // 暂停\n    pause () {\n        this._isPause = true;\n    },\n\n    // 恢复\n    resume () {\n        this._isPause = false;\n    },\n\n    stepUpdate (dt) {\n        if(this._isPause) {\n            return;\n        }\n\n        if(this._type == 0) {\n            if(this._from-- <= this._to) {\n                this._cb && this._cb.call(this._scoper);\n                this.stop();\n            }\n        } else if (this._type) {\n            if(this._from++ >= this._to) {\n                this._cb && this._cb.call(this._scoper);\n                this.stop();\n            }\n        }\n\n        this._showTimeLabel(this._from);\n    },\n\n    // 显示时间倒计时\n    _showTimeLabel: function (str) {\n        if(this._showL && this.timeLabel) {\n            this.timeLabel.node.active = true;\n            this.timeLabel.string = Math.ceil(str);\n        }\n    }\n\n});\n"]}