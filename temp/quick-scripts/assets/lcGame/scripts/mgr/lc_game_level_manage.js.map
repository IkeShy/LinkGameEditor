{"version":3,"sources":["lc_game_level_manage.js"],"names":["window","lc","GameLevelMgr","cc","Class","extends","Component","properties","levelPool","curLevel","curLevelNum","sweetsType","init","_initSweetsType","GameType","SweetsType","Blue","Green","Pink","Red","Yellow","loadCurMapInfo","level","game","trigger","Event","GameEvent","LevelLoadSuccess","jsonUrl","replace","loader","loadRes","err","data","tm","LOGE","json","getLevelInfo","setCurLevelNum","getCurLevelNum","getOneRandomSweetInfo","info","length","index","utils","randomInt","type","container","onDestroy","notifierCenter","ignoreScope"],"mappings":"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","file":"lc_game_level_manage.js","sourceRoot":"../../../../../../assets/lcGame/scripts/mgr","sourcesContent":["/**\n * 地图管理器\n * @type {*|{}}\n */\nwindow.lc = window.lc || {};\n\nlc.GameLevelMgr = cc.Class({\n\n    extends:cc.Component,\n\n    properties : {\n        levelPool: null, // 关卡\n        curLevel: null, // 当前关卡数据\n        curLevelNum: 1, // 当前关卡\n        sweetsType: null, // 糖果的类型\n    },\n\n    init : function () {\n        this.levelPool = {};\n        this.curLevel = null;\n        this.curLevelNum = 1;\n        this._initSweetsType();\n    },\n\n    /**\n     * 初始化糖果类型\n     * @private\n     */\n    _initSweetsType () {\n        this.sweetsType = [\n            lc.GameType.SweetsType.Blue,\n            lc.GameType.SweetsType.Green,\n            lc.GameType.SweetsType.Pink,\n            lc.GameType.SweetsType.Red,\n            lc.GameType.SweetsType.Yellow\n        ];\n\n    },\n\n    /**\n     * 注意：需要把json的文件放在resources中\n     *\n     */\n    loadCurMapInfo(level) {\n        this.curLevelNum = level || this.curLevelNum;\n\n        if(this.curLevelNum >= 0) {\n            let level = this.levelPool[this.curLevelNum];\n            if(level) {\n                this.curLevel = level;\n                lc.game.trigger(lc.Event.GameEvent.LevelLoadSuccess);\n            } else {\n\n                let jsonUrl = 'mapInfo/level_%d'.replace(\"%d\", this.curLevelNum);\n                cc.loader.loadRes(jsonUrl, (err, data) => {\n                    if (err) {\n                        tm.LOGE(\"加载地图出错：\" + err);\n                    } else {\n                        this.curLevel = data.json;\n                        this.levelPool[this.curLevelNum] =  data.json;\n                        lc.game.trigger(lc.Event.GameEvent.LevelLoadSuccess);\n                    }\n                });\n            }\n        }\n    },\n\n    /**\n     * 通过关卡说去数据\n     * @param level\n     * @returns {*}\n     */\n    getLevelInfo (level) {\n        this.curLevelNum = level || this.curLevelNum;\n        return this.levelPool[this.curLevelNum];\n    },\n\n    /**\n     * 当前当前地图等级\n     */\n    setCurLevelNum (level) {\n        this.curLevelNum = level;\n    },\n\n    /**\n     * 获取当前关卡数\n     */\n    getCurLevelNum () {\n        return this.curLevel || 1;\n    },\n\n    /**\n     * 获取一个随机的糖果\n     */\n    getOneRandomSweetInfo () {\n        let info = {\n            \"isOpen\":true,\n            \"container\": [lc.GameType.SweetsType.Blue]\n        };\n\n        let length = this.sweetsType.length;\n        let index = tm.utils.randomInt(0, length);\n        let type = this.sweetsType[index];\n\n        if(type) {\n            info.container[0] = type;\n        }\n\n        return info;\n    },\n\n    /**\n     * 释放函数\n     */\n    onDestroy () {\n        tm.notifierCenter.ignoreScope(this);\n\n        if(lc.game) {\n            lc.game.ignoreScope(this);\n        }\n    }\n});"]}