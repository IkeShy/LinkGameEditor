{"version":3,"sources":["lc_game_manage.js"],"names":["window","lc","GameMgr","cc","Class","extends","Component","properties","_addStepCount","_m_stepCount","_m_isUseHammer","_m_gameInfo","init","_registerEventListen","_initVariable","_initStepCount","resetAllScore","onDestroy","tm","notifierCenter","ignoreScope","game","register","Event","GameEvent","AddScore","_addScoreEventFunc","SubStepCount","_subStepCountFunc","PropEvent","UseHammer","onUseHammerFunc","info","setUseHammerToolFunc","use","data","type","score","addGreenScore","addYellowScore","addBlueScore","addRedScore","getStepCount","_addStepCountFunc","count","trigger","RefreshStep","_initCurrScore","_initAchieveScore","allScore","greenScore","yellowScore","blueScore","redScore","achieveGreen","achieveYellow","achieveBlue","achieveRed","_addAllScore","_refreshAchieveGreenScore","RefreshAchieveScore","_refreshAchieveYellowScore","_refreshAchieveBlueScore","_refreshAchieveRedScore","RefreshAllScore","getAchieveGreen","getAchieveYellow","getAchieveBlue","getAchieveRed","getScoreHistory","obj","_loadHisrotyFunc","history","flag","getUseHammerToolFunc","onAddStepToolFunc","AddStepCount","saveHistory","scene","_saveGameEleList","_saveScore","gameEleList","length","gameEle","_m_gameEleList","i","col","j","raw","logic","getComponent","getType","getLogicX","getLogicY"],"mappings":";;;;;;AAAA;;;;AAIAA,OAAOC,EAAP,GAAYD,OAAOC,EAAP,IAAa,EAAzB;;AAEAA,GAAGC,OAAH,GAAaC,GAAGC,KAAH,CAAS;;AAElBC,aAAQF,GAAGG,SAFO;;AAIlBC,gBAAa;AACTC,uBAAe,CADN,EACS;;AAElBC,sBAAc,CAHL,EAGQ;AACjBC,wBAAgB,KAJP,EAIc;;AAEvBC,qBAAa,IANJ,CAMU;AANV,KAJK;;AAalBC,UAAO,gBAAY;AACf,aAAKD,WAAL,GAAmB;AACf,2BAAe,EADA;AAEf,qBAAS;AAFM,SAAnB;;AAKA,aAAKE,oBAAL;AACA,aAAKC,aAAL;AACA,aAAKC,cAAL;AACA,aAAKC,aAAL;AACH,KAvBiB;;AAyBlB;;;AAGAC,eAAY,qBAAY;AACpBC,WAAGC,cAAH,CAAkBC,WAAlB,CAA8B,IAA9B;;AAEA,YAAGnB,GAAGoB,IAAN,EAAY;AACRpB,eAAGoB,IAAH,CAAQD,WAAR,CAAoB,IAApB;AACH;AACJ,KAlCiB;;AAoClB;;;;AAIAP,wBAxCkB,kCAwCM;AACpBZ,WAAGoB,IAAH,CAAQC,QAAR,CAAiBrB,GAAGsB,KAAH,CAASC,SAAT,CAAmBC,QAApC,EAA8C,KAAKC,kBAAnD,EAAuE,IAAvE;AACAzB,WAAGoB,IAAH,CAAQC,QAAR,CAAiBrB,GAAGsB,KAAH,CAASC,SAAT,CAAmBG,YAApC,EAAkD,KAAKC,iBAAvD,EAA0E,IAA1E;AACA3B,WAAGoB,IAAH,CAAQC,QAAR,CAAiBrB,GAAGsB,KAAH,CAASM,SAAT,CAAmBC,SAApC,EAA+C,KAAKC,eAApD,EAAqE,IAArE;;AAEA;AACA;AACH,KA/CiB;;;AAiDlB;;;AAGAA,mBApDkB,2BAoDDC,IApDC,EAoDK;AACnB,aAAKC,oBAAL,CAA0BD,KAAKE,GAA/B;AACH,KAtDiB;;;AAwDlB;;;;;AAKAR,sBA7DkB,8BA6DES,IA7DF,EA6DQ;AACtB,YAAIC,OAAOD,KAAKC,IAAhB;AACA,YAAIC,QAAQF,KAAKE,KAAjB;;AAEA,gBAAQD,IAAR;AACI,iBAAK,CAAL;AACI,qBAAKE,aAAL,CAAmBD,KAAnB;AACA;;AAEJ,iBAAK,CAAL;AACI,qBAAKE,cAAL,CAAoBF,KAApB;AACA;;AAEJ,iBAAK,CAAL;AACI,qBAAKG,YAAL,CAAkBH,KAAlB;AACA;;AAEJ,iBAAK,CAAL;AACI,qBAAKI,WAAL,CAAiBJ,KAAjB;AACA;AAfR;AAiBH,KAlFiB;;;AAoFlB;;;;AAIAvB,mBAAgB,yBAAY;AACxB,aAAKmB,oBAAL,CAA0B,KAA1B;AACH,KA1FiB;;AA4FlB;;;;AAIAlB,oBAAiB,0BAAY;AACzB,aAAKN,YAAL,GAAoB,EAApB;AACH,KAlGiB;;AAoGlB;;;;AAIAiC,kBAAe,wBAAY;AACvB,eAAO,KAAKjC,YAAZ;AACH,KA1GiB;;AA4GlB;;;;;AAKAkC,uBAAmB,2BAAUR,IAAV,EAAgB;AAC/B,YAAIS,QAAQT,KAAKS,KAAjB;AACA,YAAGA,QAAQ,CAAX,EAAc;AACV,iBAAKnC,YAAL,IAAqBmC,KAArB;AACA3C,eAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBsB,WAAnC,EAAgD,EAAC,QAAQ,KAAKrC,YAAd,EAAhD;AACH;AACJ,KAvHiB;;AAyHlB;;;;AAIAmB,uBAAmB,2BAAUO,IAAV,EAAgB;AAC/B,YAAIS,QAAQT,KAAKS,KAAjB;AACA,YAAGA,QAAQ,CAAX,EAAc;AACV,iBAAKnC,YAAL,IAAqBmC,KAArB;AACA3C,eAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBsB,WAAnC,EAAgD,EAAC,QAAQ,KAAKrC,YAAd,EAAhD;;AAEA,gBAAG,KAAKA,YAAL,IAAqB,CAAxB,EAA2B;AACvB;AACH;AACJ;AACJ,KAvIiB;;AAyIlB;;;AAGAO,mBAAgB,yBAAY;AACxB,aAAK+B,cAAL;AACA,aAAKC,iBAAL;AACH,KA/IiB;;AAiJlB;;;;AAIAD,oBAAiB,0BAAY;AACzB,aAAKE,QAAL,GAAgB,CAAhB;AACA,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKC,WAAL,GAAmB,CAAnB;AACA,aAAKC,SAAL,GAAiB,CAAjB;AACA,aAAKC,QAAL,GAAgB,CAAhB;AACH,KA3JiB;;AA6JlBL,uBAAoB,6BAAY;AAC5B,aAAKM,YAAL,GAAoB,IAApB;AACA,aAAKC,aAAL,GAAqB,IAArB;AACA,aAAKC,WAAL,GAAmB,IAAnB;AACA,aAAKC,UAAL,GAAkB,IAAlB;AACH,KAlKiB;;AAoKlB;;;AAGAnB,mBAAgB,uBAAUD,KAAV,EAAiB;AAC7B,aAAKa,UAAL,IAAmBb,KAAnB;AACA,aAAKqB,YAAL,CAAkBrB,KAAlB;AACA,aAAKsB,yBAAL;AACH,KA3KiB;;AA6KlB;;;;AAIAA,+BAA4B,qCAAY;AACpC,aAAKL,YAAL,GAAqB,KAAKA,YAAL,GAAoB,KAAKJ,UAA1B,GAAwC,CAAxC,GAA4C,CAA5C,GAAiD,KAAKI,YAAL,GAAoB,KAAKJ,UAA9F;AACAjD,WAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,OAAT,EAAkB,SAAS,KAAKN,YAAhC,EAAxD;AACH,KApLiB;;AAsLlB;;;AAGAf,oBAAiB,wBAAUF,KAAV,EAAiB;AAC9B,aAAKc,WAAL,IAAoBd,KAApB;AACA,aAAKqB,YAAL,CAAkBrB,KAAlB;AACA,aAAKwB,0BAAL;AACH,KA7LiB;;AA+LlB;;;;AAIAA,gCAA6B,sCAAY;AACrC,aAAKN,aAAL,GAAsB,KAAKA,aAAL,GAAqB,KAAKJ,WAA3B,GAA0C,CAA1C,GAA8C,CAA9C,GAAmD,KAAKI,aAAL,GAAqB,KAAKJ,WAAlG;AACAlD,WAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,QAAT,EAAmB,SAAS,KAAKL,aAAjC,EAAxD;AACH,KAtMiB;;AAwMlB;;;AAGAf,kBAAe,sBAAUH,KAAV,EAAiB;AAC5B,aAAKe,SAAL,IAAkBf,KAAlB;AACA,aAAKqB,YAAL,CAAkBrB,KAAlB;AACA,aAAKyB,wBAAL;AACH,KA/MiB;;AAiNlB;;;;AAIAA,8BAA2B,oCAAY;AACnC,aAAKN,WAAL,GAAoB,KAAKA,WAAL,GAAmB,KAAKJ,SAAzB,GAAsC,CAAtC,GAA0C,CAA1C,GAA+C,KAAKI,WAAL,GAAmB,KAAKJ,SAA1F;AACAnD,WAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,MAAT,EAAiB,SAAS,KAAKJ,WAA/B,EAAxD;AACH,KAxNiB;;AA0NlB;;;AAGAf,iBAAc,qBAAUJ,KAAV,EAAiB;AAC3B,aAAKgB,QAAL,IAAiBhB,KAAjB;AACA,aAAKqB,YAAL,CAAkBrB,KAAlB;AACA,aAAK0B,uBAAL;AACH,KAjOiB;;AAmOlB;;;;AAIAA,6BAA0B,mCAAY;AAClC,aAAKN,UAAL,GAAmB,KAAKA,UAAL,GAAkB,KAAKJ,QAAxB,GAAoC,CAApC,GAAwC,CAAxC,GAA6C,KAAKI,UAAL,GAAkB,KAAKJ,QAAtF;AACApD,WAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,KAAT,EAAgB,SAAS,KAAKH,UAA9B,EAAxD;AACH,KA1OiB;;AA4OlB;;;;;AAKAC,kBAAe,sBAAUrB,KAAV,EAAiB;AAC5B,aAAKY,QAAL,IAAiBZ,KAAjB;AACApC,WAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBwC,eAAnC,EAAoD,EAAC,SAAS,KAAKf,QAAf,EAApD;AACH,KApPiB;;AAsPlB;;;AAGAgB,qBAAiB,2BAAY;AACzB,eAAO,KAAKX,YAAZ;AACH,KA3PiB;;AA6PlB;;;AAGAY,sBAAkB,4BAAY;AAC1B,eAAO,KAAKX,aAAZ;AACH,KAlQiB;;AAoQlB;;;AAGAY,oBAAgB,0BAAY;AACxB,eAAO,KAAKX,WAAZ;AACH,KAzQiB;;AA2QlB;;;AAGAY,mBAAe,yBAAY;AACvB,eAAO,KAAKX,UAAZ;AACH,KAhRiB;;AAmRlB;;;AAGAY,qBAAiB,2BAAY;AACzB,YAAIC,MAAM;AACN,wBAAY,KAAKrB,QADX;AAEN,0BAAc,KAAKC,UAFb;AAGN,2BAAe,KAAKC,WAHd;AAIN,yBAAa,KAAKC,SAJZ;AAKN,wBAAY,KAAKC,QALX;AAMN,4BAAgB,KAAKC,YANf;AAON,6BAAiB,KAAKC,aAPhB;AAQN,2BAAe,KAAKC,WARd;AASN,0BAAc,KAAKC;AATb,SAAV;;AAYA,eAAOa,GAAP;AACH,KApSiB;;AAsSlB;;;AAGAC,sBAAkB,0BAAUpC,IAAV,EAAgB;AAC9B,YAAIqC,UAAUrC,KAAKqC,OAAnB;AACA,YAAGA,WAAWA,QAAQnC,KAAtB,EAA6B;AACzB,gBAAIL,OAAOwC,QAAQnC,KAAnB;AACA,gBAAGL,IAAH,EAAQ;AACJ,qBAAKiB,QAAL,GAAgBjB,KAAKiB,QAArB;AACA,qBAAKC,UAAL,GAAkBlB,KAAKkB,UAAvB;AACA,qBAAKC,WAAL,GAAmBnB,KAAKmB,WAAxB;AACA,qBAAKC,SAAL,GAAiBpB,KAAKoB,SAAtB;AACA,qBAAKC,QAAL,GAAgBrB,KAAKqB,QAArB;;AAEA,qBAAKC,YAAL,GAAoBtB,KAAKsB,YAAzB;AACA,qBAAKC,aAAL,GAAqBvB,KAAKuB,aAA1B;AACA,qBAAKC,WAAL,GAAmBxB,KAAKwB,WAAxB;AACA,qBAAKC,UAAL,GAAkBzB,KAAKyB,UAAvB;;AAEAxD,mBAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,OAAT,EAAkB,SAAS,KAAKN,YAAhC,EAAxD;AACArD,mBAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,QAAT,EAAmB,SAAS,KAAKL,aAAjC,EAAxD;AACAtD,mBAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,MAAT,EAAiB,SAAS,KAAKJ,WAA/B,EAAxD;AACAvD,mBAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoC,mBAAnC,EAAwD,EAAC,QAAQ,KAAT,EAAgB,SAAS,KAAKH,UAA9B,EAAxD;AACAxD,mBAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBwC,eAAnC,EAAoD,EAAC,SAAS,KAAKf,QAAf,EAApD;AACH;AACJ;AACJ,KAhUiB;;AAkUlB;AACA;;;AAGAhB,0BAAsB,8BAAUwC,IAAV,EAAgB;AAClC,aAAK/D,cAAL,GAAsB+D,IAAtB;AACH,KAxUiB;;AA0UlB;;;;AAIAC,0BAAsB,gCAAY;AAC9B,YAAID,OAAO,KAAK/D,cAAhB;AACA,aAAKA,cAAL,GAAsB,KAAtB;;AAEA,eAAO+D,IAAP;AACH,KAnViB;;AAqVlB;;;AAGAE,uBAAmB,6BAAY;AAC3B1E,WAAGoB,IAAH,CAAQwB,OAAR,CAAgB5C,GAAGsB,KAAH,CAASC,SAAT,CAAmBoD,YAAnC,EAAiD,EAAC,SAAS,KAAKpE,aAAf,EAAjD;AACH,KA1ViB;;AA4VlB;;;;AAIAqE,iBAAa,qBAAUC,KAAV,EAAiB;AAC1B,YAAGA,KAAH,EAAU;AACN,iBAAKC,gBAAL,CAAsBD,KAAtB;AACA,iBAAKE,UAAL;AACH;AACJ,KArWiB;;AAuWlB;;;;AAIAD,sBAAkB,0BAAUD,KAAV,EAAiB;AAC/B,YAAIG,cAAc,KAAKtE,WAAL,CAAiBsE,WAAnC;AACAA,oBAAYC,MAAZ,GAAqB,CAArB;;AAEA,YAAIC,UAAUL,MAAMM,cAApB;AACA,YAAGD,OAAH,EAAY;AACR,iBAAK,IAAIE,IAAI,CAAb,EAAgBA,IAAIF,QAAQD,MAA5B,EAAoCG,GAApC,EAAyC;AACrC,oBAAIC,MAAMH,QAAQE,CAAR,CAAV;AACAJ,4BAAYI,CAAZ,IAAiB,EAAjB;;AAEA,qBAAK,IAAIE,IAAG,CAAZ,EAAeA,IAAID,IAAIJ,MAAvB,EAA+BK,GAA/B,EAAqC;AACjC,wBAAIC,MAAMF,IAAIC,CAAJ,CAAV;AACA,wBAAIE,QAAQD,IAAIE,YAAJ,CAAiB,aAAjB,CAAZ;AACA,wBAAIpB,MAAM;AACN,gCAAQmB,MAAME,OAAN,EADF;AAEN,kCAAUF,MAAMG,SAAN,EAFJ;AAGN,kCAAUH,MAAMI,SAAN;AAHJ,qBAAV;;AAMAZ,gCAAYI,CAAZ,EAAeE,CAAf,IAAoBjB,GAApB;AACH;AACJ;AACJ;AACJ,KAlYiB;;AAoYlB;;;AAGAU,gBAAY,sBAAY;AACpB,YAAIR,UAAU,KAAKH,eAAL,EAAd;AACA,YAAGG,OAAH,EAAY;AACR,iBAAK7D,WAAL,CAAiB0B,KAAjB,GAAyBmC,OAAzB;AACH;AACJ;;AA5YiB,CAAT,CAAb","file":"lc_game_manage.js","sourceRoot":"../../../../../../assets/lcGame/scripts/mgr","sourcesContent":["/**\n * 内容：游戏管理器\n * @type {*|{}}\n */\nwindow.lc = window.lc || {};\n\nlc.GameMgr = cc.Class({\n\n    extends:cc.Component,\n\n    properties : {\n        _addStepCount: 3, // 道具增加步数数量\n\n        _m_stepCount: 0, // 步数\n        _m_isUseHammer: false, // 是否使用锤子\n\n        _m_gameInfo: null, // 游戏数据\n    },\n\n    init : function () {\n        this._m_gameInfo = {\n            \"gameEleList\": [],\n            \"score\": {}\n        };\n\n        this._registerEventListen();\n        this._initVariable();\n        this._initStepCount();\n        this.resetAllScore();\n    },\n\n    /**\n     * 释放函数\n     */\n    onDestroy : function () {\n        tm.notifierCenter.ignoreScope(this);\n\n        if(lc.game) {\n            lc.game.ignoreScope(this);\n        }\n    },\n\n    /**\n     * 注册消息\n     * @private\n     */\n    _registerEventListen () {\n        lc.game.register(lc.Event.GameEvent.AddScore, this._addScoreEventFunc, this);\n        lc.game.register(lc.Event.GameEvent.SubStepCount, this._subStepCountFunc, this);\n        lc.game.register(lc.Event.PropEvent.UseHammer, this.onUseHammerFunc, this);\n\n        //util.eventCenter.register(util.define.GameEvent.AddStepCount, this._addStepCountFunc, this);\n        //util.eventCenter.register(util.define.GameEvent.LoadHistory, this._loadHisrotyFunc, this);\n    },\n\n    /**\n     * 使用锤子\n     */\n    onUseHammerFunc (info) {\n        this.setUseHammerToolFunc(info.use);\n    },\n\n    /**\n     * 加分\n     * @param data\n     * @private\n     */\n    _addScoreEventFunc (data) {\n        let type = data.type;\n        let score = data.score;\n\n        switch (type) {\n            case 0:\n                this.addGreenScore(score);\n                break;\n\n            case 1:\n                this.addYellowScore(score);\n                break;\n\n            case 2:\n                this.addBlueScore(score);\n                break;\n\n            case 3:\n                this.addRedScore(score);\n                break;\n        }\n    },\n\n    /**\n     * 初始化变量\n     * @private\n     */\n    _initVariable : function () {\n        this.setUseHammerToolFunc(false);\n    },\n\n    /**\n     * 初始化步数\n     * @private\n     */\n    _initStepCount : function () {\n        this._m_stepCount = 20;\n    },\n\n    /**\n     * 获取步数\n     * @returns {number|*}\n     */\n    getStepCount : function () {\n        return this._m_stepCount;\n    },\n\n    /**\n     * 增加步数\n     * @param data\n     * @private\n     */\n    _addStepCountFunc: function (data) {\n        let count = data.count;\n        if(count > 0) {\n            this._m_stepCount += count;\n            lc.game.trigger(lc.Event.GameEvent.RefreshStep, {\"step\": this._m_stepCount});\n        }\n    },\n\n    /**\n     * 减少步数\n     * @private\n     */\n    _subStepCountFunc: function (data) {\n        let count = data.count;\n        if(count > 0) {\n            this._m_stepCount -= count;\n            lc.game.trigger(lc.Event.GameEvent.RefreshStep, {\"step\": this._m_stepCount});\n\n            if(this._m_stepCount <= 0) {\n                // 游戏结束\n            }\n        }\n    },\n\n    /**\n     * 重置分数\n     */\n    resetAllScore : function () {\n        this._initCurrScore();\n        this._initAchieveScore();\n    },\n\n    /**\n     * 初始化当前分数\n     * @private\n     */\n    _initCurrScore : function () {\n        this.allScore = 0;\n        this.greenScore = 0;\n        this.yellowScore = 0;\n        this.blueScore = 0;\n        this.redScore = 0;\n    },\n\n    _initAchieveScore : function () {\n        this.achieveGreen = 1000;\n        this.achieveYellow = 1000;\n        this.achieveBlue = 2000;\n        this.achieveRed = 4000;\n    },\n\n    /**\n     * 增加绿色分数\n     */\n    addGreenScore : function (score) {\n        this.greenScore += score;\n        this._addAllScore(score);\n        this._refreshAchieveGreenScore();\n    },\n\n    /**\n     * 刷新绿色目标分数\n     * @private\n     */\n    _refreshAchieveGreenScore : function () {\n        this.achieveGreen = (this.achieveGreen - this.greenScore) < 0 ? 0 : (this.achieveGreen - this.greenScore);\n        lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"green\", \"score\": this.achieveGreen});\n    },\n\n    /**\n     * 增加黄色分数\n     */\n    addYellowScore : function (score) {\n        this.yellowScore += score;\n        this._addAllScore(score);\n        this._refreshAchieveYellowScore();\n    },\n\n    /**\n     * 刷新黄色目标分数\n     * @private\n     */\n    _refreshAchieveYellowScore : function () {\n        this.achieveYellow = (this.achieveYellow - this.yellowScore) < 0 ? 0 : (this.achieveYellow - this.yellowScore);\n        lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"yellow\", \"score\": this.achieveYellow});\n    },\n\n    /**\n     * 增加蓝色分数\n     */\n    addBlueScore : function (score) {\n        this.blueScore += score;\n        this._addAllScore(score);\n        this._refreshAchieveBlueScore();\n    },\n\n    /**\n     * 刷新黄色目标分数\n     * @private\n     */\n    _refreshAchieveBlueScore : function () {\n        this.achieveBlue = (this.achieveBlue - this.blueScore) < 0 ? 0 : (this.achieveBlue - this.blueScore);\n        lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"blue\", \"score\": this.achieveBlue});\n    },\n\n    /**\n     * 增加红色分数\n     */\n    addRedScore : function (score) {\n        this.redScore += score;\n        this._addAllScore(score);\n        this._refreshAchieveRedScore();\n    },\n\n    /**\n     * 刷新黄色目标分数\n     * @private\n     */\n    _refreshAchieveRedScore : function () {\n        this.achieveRed = (this.achieveRed - this.redScore) < 0 ? 0 : (this.achieveRed - this.redScore);\n        lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"red\", \"score\": this.achieveRed});\n    },\n\n    /**\n     * 增加全部分数\n     * @param score\n     * @private\n     */\n    _addAllScore : function (score) {\n        this.allScore += score;\n        lc.game.trigger(lc.Event.GameEvent.RefreshAllScore, {\"score\": this.allScore});\n    },\n\n    /**\n     * 目标绿色\n     */\n    getAchieveGreen: function () {\n        return this.achieveGreen;\n    },\n\n    /**\n     * 目标黄色\n     */\n    getAchieveYellow: function () {\n        return this.achieveYellow;\n    },\n\n    /**\n     * 目标蓝色\n     */\n    getAchieveBlue: function () {\n        return this.achieveBlue;\n    },\n\n    /**\n     * 目标红色\n     */\n    getAchieveRed: function () {\n        return this.achieveRed;\n    },\n\n\n    /**\n     * 获取历史记录\n     */\n    getScoreHistory: function () {\n        let obj = {\n            \"allScore\": this.allScore,\n            \"greenScore\": this.greenScore,\n            \"yellowScore\": this.yellowScore,\n            \"blueScore\": this.blueScore,\n            \"redScore\": this.redScore,\n            \"achieveGreen\": this.achieveGreen,\n            \"achieveYellow\": this.achieveYellow,\n            \"achieveBlue\": this.achieveBlue,\n            \"achieveRed\": this.achieveRed,\n        };\n\n        return obj;\n    },\n\n    /**\n     * 读取历史记录\n     */\n    _loadHisrotyFunc: function (data) {\n        let history = data.history;\n        if(history && history.score) {\n            let info = history.score;\n            if(info){\n                this.allScore = info.allScore;\n                this.greenScore = info.greenScore;\n                this.yellowScore = info.yellowScore;\n                this.blueScore = info.blueScore;\n                this.redScore = info.redScore;\n\n                this.achieveGreen = info.achieveGreen;\n                this.achieveYellow = info.achieveYellow;\n                this.achieveBlue = info.achieveBlue;\n                this.achieveRed = info.achieveRed;\n\n                lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"green\", \"score\": this.achieveGreen});\n                lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"yellow\", \"score\": this.achieveYellow});\n                lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"blue\", \"score\": this.achieveBlue});\n                lc.game.trigger(lc.Event.GameEvent.RefreshAchieveScore, {\"type\": \"red\", \"score\": this.achieveRed});\n                lc.game.trigger(lc.Event.GameEvent.RefreshAllScore, {\"score\": this.allScore});\n            }\n        }\n    },\n\n    /*---------------道具使用-----------------*/\n    /**\n     * 设置是否用锤子\n     */\n    setUseHammerToolFunc: function (flag) {\n        this._m_isUseHammer = flag;\n    },\n\n    /**\n     * 获取是否锤子\n     * @returns {boolean|*}\n     */\n    getUseHammerToolFunc: function () {\n        let flag = this._m_isUseHammer;\n        this._m_isUseHammer = false;\n\n        return flag;\n    },\n\n    /**\n     * 使用增加步数\n     */\n    onAddStepToolFunc: function () {\n        lc.game.trigger(lc.Event.GameEvent.AddStepCount, {\"count\": this._addStepCount});\n    },\n\n    /**\n     * 保存历史记录\n     * @param scene\n     */\n    saveHistory: function (scene) {\n        if(scene) {\n            this._saveGameEleList(scene);\n            this._saveScore();\n        }\n    },\n\n    /**\n     * 保存游戏元素列表\n     * @private\n     */\n    _saveGameEleList: function (scene) {\n        let gameEleList = this._m_gameInfo.gameEleList;\n        gameEleList.length = 0;\n\n        let gameEle = scene._m_gameEleList;\n        if(gameEle) {\n            for (let i = 0; i < gameEle.length; i++) {\n                let col = gameEle[i];\n                gameEleList[i] = [];\n\n                for (let j= 0; j < col.length; j++ ) {\n                    let raw = col[j];\n                    let logic = raw.getComponent(\"lc_game_ele\");\n                    let obj = {\n                        \"type\": logic.getType(),\n                        \"logicX\": logic.getLogicX(),\n                        \"logicY\": logic.getLogicY()\n                    };\n\n                    gameEleList[i][j] = obj;\n                }\n            }\n        }\n    },\n\n    /*\n     * 保存分数\n     */\n    _saveScore: function () {\n        let history = this.getScoreHistory();\n        if(history) {\n            this._m_gameInfo.score = history;\n        }\n    },\n\n});"]}