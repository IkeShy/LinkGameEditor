{"version":3,"sources":["../../../../../assets/commonScript/utils/assets/commonScript/utils/tm_message_queue.js"],"names":["tm","window","MessageQuene","cc","Class","properties","_msgList","uuid","ctor","_scheduler","director","getScheduler","utils","destroy","_target","unschedule","step","bindTarget","target","begin","paused","isTargetPaused","schedule","macro","REPEAT_FOREVER","_isRunning","stop","isRunning","pause","restore","reset","dt","localMsg","length","msg","shift","do_logic","e","notifierCenter","trigger","Event","APP_CATCH","addCmd","push"],"mappings":";;;;;;AAAA;;;;;;AAMAA,GAAGC,MAAH,GAAYD,GAAGC,MAAH,IAAa,EAAzB;;AAEAD,GAAGE,YAAH,GAAkBC,GAAGC,KAAH,CAAS;;AAEvBC,gBAAY;AACRC,kBAAS,EADD;AAERC,cAAK,CAAC;AAFE,KAFW;;AAOvB;;AAEAC,QATuB,kBASjB;AACF,aAAKC,UAAL,GAAkBN,GAAGO,QAAH,CAAYC,YAAZ,EAAlB;AACA,aAAKJ,IAAL,GAAYP,GAAGY,KAAH,CAASL,IAAT,EAAZ;AACH,KAZsB;AAcvBM,WAduB,qBAcd;AACL,aAAKC,OAAL,GAAe,IAAf;AACA,aAAKL,UAAL,CAAgBM,UAAhB,CAA2B,KAAKC,IAAhC,EAAsC,IAAtC;AACA,aAAKV,QAAL,GAAgB,IAAhB;AACH,KAlBsB;AAoBvBW,cApBuB,sBAoBZC,MApBY,EAoBL;AACd,aAAKJ,OAAL,GAAeI,MAAf;AACH,KAtBsB;;;AAwBvB;;;;AAIAC,WAAM,iBAAW;;AAEb,YAAIC,SAAS,KAAKX,UAAL,CAAgBY,cAAhB,CAA+B,IAA/B,CAAb;;AAEA,aAAKZ,UAAL,CAAgBa,QAAhB,CAAyB,KAAKN,IAA9B,EAAoC,IAApC,EAA0C,CAA1C,EAA6Cb,GAAGoB,KAAH,CAASC,cAAtD,EAAsE,CAAtE,EAAyEJ,MAAzE;;AAEA,aAAKK,UAAL,GAAkB,IAAlB;AACH,KAnCsB;;AAqCvB;;;AAGAC,UAAK,gBAAU;AACX,aAAKjB,UAAL,CAAgBM,UAAhB,CAA2B,KAAKC,IAAhC,EAAsC,IAAtC;;AAEA,aAAKS,UAAL,GAAkB,KAAlB;AACH,KA5CsB;AA6CvB;;;;AAIAE,eAAU,qBAAU;AAChB,eAAO,KAAKF,UAAZ;AACH,KAnDsB;AAoDvB;;;AAGAG,WAAM,iBAAU;AACZ,aAAKH,UAAL,GAAkB,KAAlB;AACH,KAzDsB;AA0DvB;;;AAGAI,aAAQ,mBAAU;AACd,aAAKJ,UAAL,GAAkB,IAAlB;AACH,KA/DsB;;AAiEvBK,SAjEuB,mBAiEhB;AACH,aAAKxB,QAAL,GAAgB,EAAhB;AACH,KAnEsB;;;AAqEvBU,UAAK,cAASe,EAAT,EAAY;AACb,YAAG,CAAC,KAAKN,UAAT,EAAoB;AAChB;AACH;;AAED,YAAI;AACA,gBAAIO,WAAW,KAAK1B,QAAL,IAAiB,EAAhC;AACA,gBAAG,KAAKQ,OAAL,IAAgBkB,SAASC,MAAT,GAAkB,CAArC,EAAuC;AACnC,oBAAIC,MAAMF,SAASG,KAAT,EAAV;AACA,oBAAG,KAAKrB,OAAL,CAAasB,QAAhB,EAAyB;AACrB,yBAAKtB,OAAL,CAAasB,QAAb,CAAsBF,GAAtB;AACH;AACJ;AACJ,SARD,CAQC,OAAMG,CAAN,EAAQ;AACLrC,eAAGsC,cAAH,CAAkBC,OAAlB,CAA0BvC,GAAGwC,KAAH,CAASC,SAAnC,EAA8CJ,CAA9C;AACH;AACJ,KArFsB;;AAuFvB;;;;AAIAK,YAAO,gBAASR,GAAT,EAAa;AAChB,YAAG,CAAC,KAAK5B,QAAT,EAAkB;AACd;AACH;;AAED,YAAI;AACA,iBAAKA,QAAL,CAAcqC,IAAd,CAAmBT,GAAnB;AACH,SAFD,CAEC,OAAMG,CAAN,EAAQ;AACLrC,eAAGsC,cAAH,CAAkBC,OAAlB,CAA0BvC,GAAGwC,KAAH,CAASC,SAAnC,EAA8CJ,CAA9C;AACH;AACJ;AACD;AAtGuB,CAAT,CAAlB","file":"tm_message_queue.js","sourceRoot":"../../../../../assets/commonScript/utils","sourcesContent":["/**\n *\n * 内容: 消息队列\n *\n */\n\ntm.window = tm.window || {};\n\ntm.MessageQuene = cc.Class({\n\n    properties: {\n        _msgList:[],\n        uuid:-1,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    ctor(){\n        this._scheduler = cc.director.getScheduler();\n        this.uuid = tm.utils.uuid();\n    },\n\n    destroy(){\n        this._target = null;\n        this._scheduler.unschedule(this.step, this);\n        this._msgList = null;\n    },\n\n    bindTarget(target){\n        this._target = target;\n    },\n\n    /*\n    **\n    * 演算开始\n    */\n    begin:function() {\n\n        var paused = this._scheduler.isTargetPaused(this);\n\n        this._scheduler.schedule(this.step, this, 0, cc.macro.REPEAT_FOREVER, 0, paused);\n\n        this._isRunning = true;\n    },\n\n    /**\n     * 停止\n     */\n    stop:function(){\n        this._scheduler.unschedule(this.step, this);\n\n        this._isRunning = false;\n    },\n    /**\n     * s\n     * @returns {boolean}\n     */\n    isRunning:function(){\n        return this._isRunning;\n    },\n    /**\n     * 暂停\n     */\n    pause:function(){\n        this._isRunning = false;\n    },\n    /**\n     * 继续\n     */\n    restore:function(){\n        this._isRunning = true;\n    },\n\n    reset(){\n        this._msgList = [];\n    },\n\n    step:function(dt){\n        if(!this._isRunning){\n            return;\n        }\n\n        try {\n            var localMsg = this._msgList || [];\n            if(this._target && localMsg.length > 0){\n                var msg = localMsg.shift();\n                if(this._target.do_logic){\n                    this._target.do_logic(msg);\n                }\n            }\n        }catch(e){\n            tm.notifierCenter.trigger(tm.Event.APP_CATCH, e);\n        }\n    },\n\n    /**\n     * 公共命令添加\n     * @param cmd\n     */\n    addCmd:function(msg){\n        if(!this._msgList){\n            return;\n        }\n\n        try {\n            this._msgList.push(msg);\n        }catch(e){\n            tm.notifierCenter.trigger(tm.Event.APP_CATCH, e);\n        }\n    }\n    // update (dt) {},\n});"]}