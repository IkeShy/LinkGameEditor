{"version":3,"sources":["../../../../../assets/commonScript/utils/assets/commonScript/utils/tm_utils_funs.js"],"names":["crypto","require","tm","utils","seedRandomTimes","uuid","len","radix","chars","split","i","length","Math","random","r","join","isNullorUndefined","a","seededRandom","min","max","seed","rnd","seededRandomInt","round","randomInt","range","rand","setRandomSeed","adaptiveWin","canvas","cc","Canvas","instance","rateR","designResolution","height","width","rateV","view","getVisibleSize","log","fitHeight","fitWidth","pdf2cdf","pdf","cdf","slice","discreteSampling","y","x","isIphoneX","v_size","getFrameSize","isIOS","sys","os","OS_IOS","LOGD","checkFlagByKey","key","value","localStorage","getItem","showTimeBy_H_M_S","second","timeArr","last_s","h","floor","push","m","s","showTimeBy_M_S_MS","mSecond","last_ms","ms","isShareTicketSaved","shareTicket","valueStr","savedTickets","JSON","parse","isShareTicketSameDay","nowDate","Date","saveDate","getDate","clearShareTicket","stringify","setItem","saveShareTicket","getTime","onWechatDecrypt","data","callfunc","_getDecryptCallback","target","_getDecryptTarget","result","code","mySdk","account","wxgame_sessionKey","decryptData","call","decryptShareTicket","shareCb","self","shareApi","getShareInfo","flag","res","encryptedData","iv","_isDecryptShareTicketMsgReg","pm","game","listenMsg","requestMsg","resultString","decrypt","crypted","decoded","Buffer","decipher","createDecipheriv","setAutoPadding","update","final","err","getCurrTime","parseInt"],"mappings":"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","file":"tm_utils_funs.js","sourceRoot":"../../../../../assets/commonScript/utils","sourcesContent":["/**\n *\n *\n */\nlet crypto = require('crypto');\n\ntm.utils = {\n    seedRandomTimes: 0,\n\n    /**\n     * 自定义UUID,不能确保100%唯一\n     * @param len 长度\n     * @param radix 2/10/16 进制数\n     * @returns {string}\n     */\n    uuid : function (len, radix) {\n        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\n        var uuid = [], i;\n        radix = radix || chars.length;\n\n        if (len) {\n            // Compact form\n            for (i = 0; i < len; i++) uuid[i] = chars[0 | Math.random() * radix];\n        } else {\n            // rfc4122, version 4 form\n            var r;\n\n            // rfc4122 requires these characters\n            uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\n            uuid[14] = '4';\n\n            // Fill in random data.  At i==19 set the high bits of clock sequence as\n            // per rfc4122, sec. 4.1.5\n            for (i = 0; i < 36; i++) {\n                if (!uuid[i]) {\n                    r = 0 | Math.random() * 16;\n                    uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n                }\n            }\n        }\n\n        return uuid.join('');\n    },\n\n\n    isNullorUndefined:function (a) {\n        if(typeof a == 'undefined' || typeof a == 'null'){\n            return true;\n        }\n\n        return false;\n    },\n\n    /**\n     * 只有对战游戏，想获得相同随机数时才调用\n     * 伪随机\n     * @param min\n     * @param max\n     * @returns {string}\n     */\n    seededRandom : function(min, max) {\n        max = max || 1;\n        min = min || 0;\n\n        Math.seed = Math.seed || 58215;\n        Math.seed = (Math.seed * 9301 + 49297) % 233280;\n\n        var rnd = Math.seed / 233280.0;\n\n        this.seedRandomTimes ++;\n        return  (min + rnd * (max - min));\n    },\n\n    seededRandomInt: function(min, max) {\n        return Math.round(this.seededRandom(min, max));\n    },\n\n    /**\n     * 纯随机，没有随机种子\n     * @param min\n     * @param max\n     * @returns {number}\n     */\n    randomInt: function(min, max) {\n        let range = max - min;\n        let rand = Math.random();\n        return Math.round(min + rand * range);\n    },\n\n    /**\n     * 其他地方不要调用，平台维护\n     * @param seed\n     */\n    setRandomSeed:function(seed){\n        Math.seed = seed;\n        this.seedRandomTimes = 0;\n    },\n\n    /**\n     * 屏幕适配\n     * @param node\n     */\n    adaptiveWin:function () {\n\n        let canvas = cc.Canvas.instance;\n\n        // 设计分辨率比\n        let rateR = canvas.designResolution.height / canvas.designResolution.width;\n\n        // 显示分辨率比\n        let rateV = cc.view.getVisibleSize().height / cc.view.getVisibleSize().width;\n        cc.log(\"winSize: rateR: \"+rateR+\" rateV: \"+rateV);\n\n        if (rateV > rateR) {\n            canvas.fitHeight = false;\n            canvas.fitWidth = true;\n            cc.log(\"winSize: fitWidth\");\n        } else {\n            canvas.fitHeight = true;\n            canvas.fitWidth = false;\n            cc.log(\"winSize: fitHeight\");\n        }\n    },\n\n    /**\n     * pdf2cdf  PDF:密度 CDF:分布\n     * @param pdf\n     * @returns {Array.<T>|string|Blob|ArrayBuffer}\n     */\n    pdf2cdf : function (pdf) {\n        var cdf = pdf.slice() || [];\n\n        for (var i = 1; i < cdf.length - 1; i++)\n            cdf[i] += cdf[i - 1];\n\n        // Force set last cdf to 1, preventing floating-point summing error in the loop.\n        cdf[cdf.length - 1] = 1;\n\n        return cdf;\n    },\n\n    /**\n     * 根据分布值,离散取样\n     * @param cdf\n     * @returns {*}\n     */\n    discreteSampling : function (cdf) {\n        var y = Math.random();\n        for (var x in cdf)\n            if (y < cdf[x])\n                return x;\n\n        return -1; // should never runs here, assuming last element in cdf is 1\n    },\n\n    /**\n     * 判断是iPhoneX\n     * @returns {boolean}\n     */\n    isIphoneX : function () {\n        // var glView = cc.director.getOpenGLView();\n        let v_size = cc.view.getFrameSize();\n        let isIOS = (cc.sys.os == cc.sys.OS_IOS);\n        tm.LOGD(\"isIphoneX isIOS\",'isIphoneX--'+v_size.width+'---'+v_size.height, isIOS);\n        if (isIOS && v_size.width == 375&& v_size.height == 812) {\n            return true;\n        }\n        return false;\n    },\n\n    checkFlagByKey(key){\n        if(!key){\n            return false;\n        }\n\n        let value = tm.localStorage.getItem(key) || \"\";\n\n        return value == 'true';\n    },\n\n    /**\n     * 显示倒计时 时-分-秒\n     * 00:00:00\n     * @returns {Arry}\n     */\n    showTimeBy_H_M_S : function (second) {\n        let timeArr = [];\n\n        let last_s = second;\n        let h = Math.floor(last_s/3600);\n        if (!h) {\n            timeArr.push('00');\n        }\n        else if (h < 10) {\n            timeArr.push('0' + h);\n        }\n        else {\n            timeArr.push(h);\n        }\n\n        last_s = second%3600;\n        let m = Math.floor(last_s/60);\n        if (!m) {\n            timeArr.push('00');\n        }\n        else if (m < 10) {\n            timeArr.push('0' + m);\n        }\n        else {\n            timeArr.push(m);\n        }\n\n        let s = last_s%60;\n        if (!s) {\n            timeArr.push('00');\n        }\n        else if (s < 10) {\n            timeArr.push('0' + s);\n        }\n        else {\n            timeArr.push(s);\n        }\n\n        return timeArr;\n    },\n\n    /**\n     * 显示倒计时 分-秒-毫秒\n     * 00:00:00\n     * @returns {Arry}\n     */\n    showTimeBy_M_S_MS : function (mSecond) {\n        let timeArr = [];\n\n        let last_ms = mSecond;\n        let m = Math.floor(last_ms/(60*1000));\n        if (!m) {\n            timeArr.push('00');\n        }\n        else if (m < 10) {\n            timeArr.push('0' + m);\n        }\n        else {\n            timeArr.push(m);\n        }\n\n        last_ms = last_ms%(60*1000);\n        let s = Math.floor(last_ms/(1000));\n        if (!s) {\n            timeArr.push('00');\n        }\n        else if (s < 10) {\n            timeArr.push('0' + s);\n        }\n        else {\n            timeArr.push(s);\n        }\n\n        last_ms = last_ms%(1000);\n        let ms = Math.floor(last_ms/(10));\n        if (!ms) {\n            timeArr.push('00');\n        }\n        else if (ms < 10) {\n            timeArr.push('0' + ms);\n        }\n        else {\n            timeArr.push(ms);\n        }\n\n        return timeArr;\n    },\n\n    /**\n     * 检查指定shareTicket是否在存储记录中\n     * @param shareTicket\n     */\n    isShareTicketSaved (shareTicket) {\n        tm.LOGD(\"tm.uitls.isShareTicketSaved: \" + shareTicket);\n\n        let valueStr = tm.localStorage.getItem('savedTickets');\n        let savedTickets = null;\n\n        tm.LOGD(\"valueStr: \" + valueStr);\n\n        if (valueStr) {\n            savedTickets = JSON.parse(valueStr);\n        }\n\n        return savedTickets ? !!savedTickets[shareTicket] : false;\n    },\n\n    /**\n     * 检查指定shareTicket是否为同一天\n     * 以零点为界, 超过零点即为超过一天\n     * @param shareTicket\n     * @returns {boolean}\n     */\n    isShareTicketSameDay (shareTicket) {\n        //\n        tm.LOGD(\"tm.uitls.isShareTicketPassedDay: \" + shareTicket);\n\n        let valueStr = tm.localStorage.getItem('savedTickets');\n        let savedTickets = null;\n\n        tm.LOGD(\"valueStr: \" + valueStr);\n\n        if (valueStr) {\n            savedTickets = JSON.parse(valueStr);\n        }\n\n        if (!savedTickets[shareTicket]) {\n            tm.LOGD(\"shareTicket not saved: \" + valueStr);\n            return false;\n        }\n\n        let nowDate = new Date();\n        let saveDate = new Date(savedTickets[shareTicket]);\n\n        return nowDate.getDate() === saveDate.getDate();\n    },\n\n    /**\n     * 清除一个保存的shareTicket\n     * @param shareTicket\n     */\n    clearShareTicket (shareTicket) {\n        tm.LOGD(\"tm.uitls.clearShareTicket: \" + shareTicket);\n\n        let valueStr = tm.localStorage.getItem('savedTickets');\n        let savedTickets = null;\n\n        tm.LOGD(\"valueStr: \" + valueStr);\n\n        if (valueStr) {\n            savedTickets = JSON.parse(valueStr);\n        }\n\n        if (savedTickets[shareTicket]) {\n            delete savedTickets[shareTicket];\n\n            // 回写保存\n            valueStr = JSON.stringify(savedTickets);\n            tm.localStorage.setItem('savedTickets', valueStr);\n        }\n    },\n\n    /**\n     * 检查指定shareTicket是否在存储记录中\n     * @param shareTicket\n     */\n    saveShareTicket (shareTicket) {\n        tm.LOGD(\"tm.uitls.saveShareTicket: \" + shareTicket);\n\n        let valueStr = tm.localStorage.getItem('savedTickets');\n        let savedTickets = {};\n\n        tm.LOGD(\"valueStr: \" + valueStr);\n\n        if (valueStr) {\n            savedTickets = JSON.parse(valueStr);\n        }\n\n        savedTickets[shareTicket] = new Date().getTime();\n\n        //\n        valueStr = JSON.stringify(savedTickets);\n        tm.localStorage.setItem('savedTickets', valueStr);\n    },\n\n    /**\n     * 接收到服务器返回的群id信息\n     * @param data\n     */\n    onWechatDecrypt (data) {\n        tm.LOGD(\"tm.uitls.onWechatDecrypt: \", data);\n\n        let callfunc = this._getDecryptCallback;\n        let target = this._getDecryptTarget;\n        let result = null;\n\n        if (data.code === 0) {\n            mySdk.account.wxgame_sessionKey = data.wxgame_sessionKey;\n\n            let decryptData = JSON.parse(data['decryptMsg']);\n            if (decryptData) {\n                result = decryptData['openGId'];\n            }\n        }\n\n        tm.LOGD(\"result openGId: \", result);\n\n        if (callfunc) {\n            if (target) {\n                callfunc.call(target, result);\n            } else {\n                callfunc(result);\n            }\n        }\n\n        this._getDecryptCallback = null;\n        this._getDecryptTarget = null;\n    },\n\n    /**\n     * 解密群分享的ShareTicket, 得到该群的id信息\n     * @param shareTicket\n     * @param callfunc\n     * @param target\n     */\n    decryptShareTicket (shareTicket, callfunc, target, shareCb) {\n        //\n        tm.LOGD(\"tm.uitls.decryptShareTicket: \" + shareTicket);\n\n        let self = this;\n        mySdk.shareApi.getShareInfo({\n                \"target\": this,\n                \"shareTicket\": shareTicket,\n                \"cb\": function (flag, res, code) {\n                    if (flag) {\n                        tm.LOGD(\"getShareInfo encryptedData: \", res.encryptedData);\n                        tm.LOGD(\"_sendItemGive \", res.iv);\n\n                        shareCb && shareCb(false, res, code);\n\n                        if (code != -1 || !mySdk.account.wxgame_sessionKey) {       //  wxgame_sessionKey 过期\n                            //\n                            this._getDecryptCallback = callfunc;\n                            this._getDecryptTarget = target;\n\n                            if (!this._isDecryptShareTicketMsgReg) {\n                                pm.game.listenMsg(\"game_wechatDecrypt\",   this.onWechatDecrypt,  this);\n                                this._isDecryptShareTicketMsgReg = true;\n                            }\n\n                            pm.game.requestMsg(\"game_wechatDecrypt\", {\n                                \"iv\": res.iv,\n                                \"encryptedData\": res.encryptedData,\n                                \"code\": code\n                            });\n\n                            return;\n                        }\n\n                        let resultString = self.decrypt(mySdk.account.wxgame_sessionKey, res.iv, res.encryptedData);\n                        let decryptData = JSON.parse(resultString);\n                        let result = decryptData ? decryptData['openGId'] : null;\n\n                        if (callfunc) {\n                            if (target) {\n                                callfunc.call(target, result);\n                            } else {\n                                callfunc(result);\n                            }\n                        }\n                    } else {\n                        // 失败，立即回调\n                        if (callfunc) {\n                            if (target) {\n                                callfunc.call(target, null);\n                            } else {\n                                callfunc(null);\n                            }\n                        }\n\n                        //self._getDecryptCallback = null;\n                        //self._getDecryptTarget = null;\n\n                        shareCb && shareCb(true);\n                    }\n                }\n            }\n        );\n    },\n\n    decrypt (key, iv, crypted) {\n        var decoded = 0;\n        try {\n            crypted = new Buffer(crypted, 'base64');\n            iv = new Buffer(iv, 'base64');\n            key = new Buffer(key, 'base64');\n\n            let decipher = crypto.createDecipheriv('aes-128-cbc', key, iv);\n            decipher.setAutoPadding(true);\n\n            decoded = decipher.update(crypted, 'binary', 'utf8');\n            decoded += decipher.final('utf8');\n        } catch (err){\n\n        }\n\n        return decoded;\n    },\n\n    /**\n     * 获取当前时间 秒数\n     * @returns {number}\n     */\n    getCurrTime () {\n        return parseInt(new Date().getTime() / 1000);\n    },\n\n\n};"]}